<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>IPv4 Subnet Calculator</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--muted:#94a3b8;--accent:#06b6d4;--accent-2:#7c3aed;--glass: rgba(255,255,255,0.04)}
    html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;color:#e6eef6;background:linear-gradient(180deg,#071025 0%, #071421 60%);-webkit-font-smoothing:antialiased}
    .app{max-width:980px;margin:32px auto;padding:24px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));box-shadow:0 10px 30px rgba(2,6,23,0.6);}
    header{display:flex;align-items:center;gap:16px}
    header h1{margin:0;font-size:20px}
    .controls{display:grid;grid-template-columns:1fr 180px 120px;gap:12px;margin-top:18px}
    .input, .btn{background:var(--glass);padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.03)}
    .input input{width:100%;background:transparent;border:0;color:inherit;font-size:16px;outline:none}
    .small{font-size:13px;color:var(--muted)}
    .btn{display:flex;align-items:center;justify-content:center;cursor:pointer;border:1px solid rgba(255,255,255,0.04)}
    .btn.primary{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#042027;font-weight:600}
    .results{margin-top:20px;display:grid;grid-template-columns:1fr 1fr;gap:18px}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:16px;border-radius:10px;border:1px solid rgba(255,255,255,0.03)}
    table{width:100%;border-collapse:collapse;color:#d9eef8}
    td,th{padding:8px 6px;text-align:left;border-bottom:1px dashed rgba(255,255,255,0.03);font-size:14px}
    .mono{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono",monospace;font-size:13px}
    .binary{font-family:ui-monospace,monospace;background:rgba(255,255,255,0.02);padding:6px;border-radius:6px;display:inline-block}
    .status{display:inline-block;padding:6px 8px;border-radius:999px;font-weight:600;font-size:12px}
    .status.private{background:rgba(124,58,237,0.13);color:var(--accent-2)}
    .status.public{background:rgba(6,182,212,0.08);color:var(--accent)}
    .footer{margin-top:18px;color:var(--muted);font-size:13px}
    .row{display:flex;gap:10px;align-items:center}
    .copy{cursor:pointer;padding:6px;border-radius:6px;border:1px solid rgba(255,255,255,0.03);background:transparent}
    @media (max-width:820px){.controls{grid-template-columns:1fr 120px 100px}.results{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="app">
    <header>
      <svg width="40" height="40" viewBox="0 0 24 24" fill="none" aria-hidden>
        <rect x="2" y="2" width="20" height="20" rx="5" fill="#071422" stroke="#0ea5a4" stroke-width="1.5" />
        <path d="M6 8h12M6 12h4M6 16h8" stroke="#06b6d4" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <div>
        <h1>IPv4 Subnet Calculator</h1>
        <div class="small">Enter address as <code class="mono">192.168.1.10/24</code> or <code class="mono">192.168.1.10 255.255.255.0</code></div>
      </div>
    </header>

    <div class="controls">
      <div class="input" style="display:flex;flex-direction:column">
        <label class="small">IPv4 Address & Mask</label>
        <input id="addrInput" placeholder="e.g. 192.168.1.10/24 or 10.0.0.5 255.0.0.0" />
      </div>
      <div class="input" style="display:flex;flex-direction:column">
        <label class="small">Optional: Prefix length</label>
        <input id="prefixInput" placeholder="e.g. 24" />
      </div>
      <div style="display:flex;flex-direction:column;gap:8px">
        <div class="btn primary" id="calcBtn">Calculate</div>
        <div class="btn" id="resetBtn">Reset</div>
      </div>
    </div>

    <div id="message" class="small" style="margin-top:12px;color:#fca5a5"></div>

    <div class="results" id="results" style="display:none">
      <div class="card">
        <h3 style="margin-top:0">Summary</h3>
        <table>
          <tbody>
            <tr><th>Address</th><td id="r_address"></td></tr>
            <tr><th>Netmask</th><td id="r_netmask"></td></tr>
            <tr><th>Wildcard Mask</th><td id="r_wildcard"></td></tr>
            <tr><th>Network</th><td id="r_network"></td></tr>
            <tr><th>Broadcast</th><td id="r_broadcast"></td></tr>
            <tr><th>Host Min</th><td id="r_hostmin"></td></tr>
            <tr><th>Host Max</th><td id="r_hostmax"></td></tr>
            <tr><th>Hosts / Net</th><td id="r_hostsnet"></td></tr>
            <tr><th>Class</th><td id="r_class"></td></tr>
            <tr><th>Private / Public</th><td id="r_scope"></td></tr>
          </tbody>
        </table>
      </div>

      <div class="card">
        <h3 style="margin-top:0">Binary & Details</h3>
        <table>
          <thead>
            <tr><th style="width:30%">Field</th><th>Value</th><th>Binary</th></tr>
          </thead>
          <tbody>
            <tr><td>Address</td><td id="b_address" class="mono"></td><td id="b_address_bin"></td></tr>
            <tr><td>Netmask</td><td id="b_netmask" class="mono"></td><td id="b_netmask_bin"></td></tr>
            <tr><td>Wildcard</td><td id="b_wildcard" class="mono"></td><td id="b_wildcard_bin"></td></tr>
            <tr><td>Network</td><td id="b_network" class="mono"></td><td id="b_network_bin"></td></tr>
            <tr><td>Broadcast</td><td id="b_broadcast" class="mono"></td><td id="b_broadcast_bin"></td></tr>
            <tr><td>HostMin</td><td id="b_hostmin" class="mono"></td><td id="b_hostmin_bin"></td></tr>
            <tr><td>HostMax</td><td id="b_hostmax" class="mono"></td><td id="b_hostmax_bin"></td></tr>
          </tbody>
        </table>
        <div style="margin-top:12px;display:flex;gap:8px;flex-wrap:wrap">
          <button class="copy" id="copyAll">Copy results</button>
          <button class="copy" id="downloadCSV">Download CSV</button>
          <div style="flex:1"></div>
          <div class="small">Tip: click <span class="mono">Copy results</span> to paste into docs or GitHub README.</div>
        </div>
      </div>
    </div>

    <div class="footer">Built for GitHub — single-file HTML + JS. Works offline in modern browsers.</div>
  </div>

  <script>
    // Utilities
    function ipToInt(ip){
      const parts = ip.trim().split('.').map(x=>parseInt(x,10));
      if(parts.length!==4 || parts.some(p=>isNaN(p)||p<0||p>255)) return null;
      return ((parts[0]<<24)>>>0) + ((parts[1]<<16)>>>0) + ((parts[2]<<8)>>>0) + (parts[3]>>>0);
    }
    function intToIp(int){
      return [(int>>>24)&255, (int>>>16)&255, (int>>>8)&255, int&255].join('.');
    }
    function intToBinaryOctets(int){
      return [ (int>>>24)&255, (int>>>16)&255, (int>>>8)&255, int&255 ].map(n=>n.toString(2).padStart(8,'0')).join(' ');
    }
    function prefixToMask(prefix){
      if(prefix<0||prefix>32) return null;
      const mask = prefix===0?0:(~((1<< (32-prefix)) -1))>>>0;
      return mask;
    }
    function maskToPrefix(maskInt){
      // count ones
      let c = 0; for(let i=31;i>=0;i--){ if(maskInt & (1<<i)) c++; else break; } if(((maskInt<< (c))>>>0) !== 0) return null; return c;
    }
    function wildcardFromMask(maskInt){ return (~maskInt)>>>0 }
    function isPrivate(ipInt){
      // RFC1918: 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16
      if((ipInt>>>24)===10) return true;
      if((ipInt>>>20) === ((172<<4) + (16>>>0))){} // not straightforward—use ranges
      if(ipInt>=ipToInt('172.16.0.0') && ipInt<=ipToInt('172.31.255.255')) return true;
      if(ipInt>=ipToInt('192.168.0.0') && ipInt<=ipToInt('192.168.255.255')) return true;
      return false;
    }
    function classOf(ipInt){
      const first = (ipInt>>>24)&255;
      if(first<=127) return 'A';
      if(first<=191) return 'B';
      if(first<=223) return 'C';
      if(first<=239) return 'D (Multicast)';
      return 'E (Reserved)';
    }

    // Main
    const addrInput = document.getElementById('addrInput');
    const prefixInput = document.getElementById('prefixInput');
    const calcBtn = document.getElementById('calcBtn');
    const resetBtn = document.getElementById('resetBtn');
    const results = document.getElementById('results');
    const msg = document.getElementById('message');

    function showMessage(s,err=false){ msg.style.color = err? '#fca5a5' : '#9ae6b4'; msg.textContent = s }

    function parseInput(raw, explicitPrefix){
      raw = raw.trim();
      if(!raw) return null;
      // possible formats: ip/prefix, ip mask, ip only
      let ipStr = raw; let prefix = null; let maskStr = null;
      // detect slash
      if(raw.includes('/')){
        const [a,p] = raw.split('/'); ipStr = a.trim(); prefix = parseInt(p.trim(),10);
      } else if(raw.split(' ').length===2){
        const [a,b] = raw.split(' '); ipStr = a.trim(); maskStr = b.trim();
        if(maskStr.includes('.')){
          const mInt = ipToInt(maskStr); if(mInt===null) return null; prefix = maskToPrefix(mInt);
        } else {
          prefix = parseInt(maskStr,10);
        }
      }
      if(explicitPrefix){ const px = parseInt(explicitPrefix,10); if(!isNaN(px)) prefix = px; }
      const ipInt = ipToInt(ipStr); if(ipInt===null) return null;
      if(prefix===null || isNaN(prefix)) return {ipInt, prefix:null};
      if(prefix<0||prefix>32) return null;
      return {ipInt, prefix};
    }

    function calculate(ipInt, prefix){
      const maskInt = prefixToMask(prefix);
      const wild = wildcardFromMask(maskInt);
      const network = (ipInt & maskInt)>>>0;
      const broadcast = (network | wild)>>>0;
      let hostMin = null, hostMax = null, hostsPer = 0;
      if(prefix<=30){ hostsPer = (1 << (32 - prefix)) - 2; hostMin = (network + 1)>>>0; hostMax = (broadcast - 1)>>>0; }
      else if(prefix===31){ hostsPer = 0; hostMin = network; hostMax = broadcast; } // point-to-point
      else if(prefix===32){ hostsPer = 1; hostMin = network; hostMax = network; }
      return {maskInt,wild,network,broadcast,hostMin,hostMax,hostsPer};
    }

    function renderAll(parsed){
      if(!parsed) return;
      const {ipInt,prefix} = parsed;
      if(prefix===null){ showMessage('Mask/prefix missing or unparsable', true); return }
      const data = calculate(ipInt,prefix);
      // Summary
      document.getElementById('r_address').innerHTML = '<span class="mono">' + intToIp(ipInt) + '/' + prefix + '</span> <button class="copy" onclick="copyText(\''+intToIp(ipInt)+'/'+prefix+'\')">Copy</button>';
      document.getElementById('r_netmask').innerHTML = '<span class="mono">' + intToIp(data.maskInt) + ' /' + prefix + '</span>';
      document.getElementById('r_wildcard').innerHTML = '<span class="mono">' + intToIp(data.wild) + '</span>';
      document.getElementById('r_network').innerHTML = '<span class="mono">' + intToIp(data.network) + '</span>';
      document.getElementById('r_broadcast').innerHTML = '<span class="mono">' + intToIp(data.broadcast) + '</span>';
      document.getElementById('r_hostmin').innerHTML = data.hostMin===null? '-' : '<span class="mono">'+intToIp(data.hostMin)+'</span>';
      document.getElementById('r_hostmax').innerHTML = data.hostMax===null? '-' : '<span class="mono">'+intToIp(data.hostMax)+'</span>';
      document.getElementById('r_hostsnet').innerHTML = data.hostsPer < 0 ? '0' : data.hostsPer.toString();
      // class & scope
      const scope = isPrivate(ipInt)? 'Private' : 'Public';
      document.getElementById('r_class').textContent = classOf(ipInt);
      const scopeEl = document.getElementById('r_scope'); scopeEl.innerHTML = '<span class="status '+(scope.toLowerCase())+'">'+scope+'</span>';

      // Binary details
      document.getElementById('b_address').textContent = intToIp(ipInt);
      document.getElementById('b_address_bin').innerHTML = '<span class="binary">' + intToBinaryOctets(ipInt) + '</span>';

      document.getElementById('b_netmask').textContent = intToIp(data.maskInt) + ' /' + prefix;
      document.getElementById('b_netmask_bin').innerHTML = '<span class="binary">' + intToBinaryOctets(data.maskInt) + '</span>';

      document.getElementById('b_wildcard').textContent = intToIp(data.wild);
      document.getElementById('b_wildcard_bin').innerHTML = '<span class="binary">' + intToBinaryOctets(data.wild) + '</span>';

      document.getElementById('b_network').textContent = intToIp(data.network);
      document.getElementById('b_network_bin').innerHTML = '<span class="binary">' + intToBinaryOctets(data.network) + '</span>';

      document.getElementById('b_broadcast').textContent = intToIp(data.broadcast);
      document.getElementById('b_broadcast_bin').innerHTML = '<span class="binary">' + intToBinaryOctets(data.broadcast) + '</span>';

      document.getElementById('b_hostmin').textContent = data.hostMin===null? '-' : intToIp(data.hostMin);
      document.getElementById('b_hostmin_bin').innerHTML = data.hostMin===null? '-' : '<span class="binary">' + intToBinaryOctets(data.hostMin) + '</span>';

      document.getElementById('b_hostmax').textContent = data.hostMax===null? '-' : intToIp(data.hostMax);
      document.getElementById('b_hostmax_bin').innerHTML = data.hostMax===null? '-' : '<span class="binary">' + intToBinaryOctets(data.hostMax) + '</span>';

      results.style.display = 'grid';
      showMessage('Calculated ✓');
    }

    window.copyText = function(s){ navigator.clipboard.writeText(s).then(()=> showMessage('Copied to clipboard')) }

    calcBtn.addEventListener('click', ()=>{
      showMessage('');
      const parsed = parseInput(addrInput.value, prefixInput.value);
      if(!parsed){ showMessage('Invalid input. Use format 192.168.1.10/24 or 10.0.0.5 255.0.0.0', true); results.style.display='none'; return }
      if(parsed.prefix===null){ showMessage('Prefix could not be determined. Please specify a prefix (e.g. /24).', true); results.style.display='none'; return }
      try{ renderAll(parsed); } catch(e){ console.error(e); showMessage('Error during calculation', true) }
    });

    resetBtn.addEventListener('click', ()=>{ addrInput.value=''; prefixInput.value=''; results.style.display='none'; msg.textContent=''; });

    document.getElementById('copyAll').addEventListener('click', ()=>{
      const lines = [];
      const rows = document.querySelectorAll('.card table tbody tr');
      rows.forEach(r=>{ const k = r.children[0].innerText.trim(); const v = r.children[1] ? r.children[1].innerText.trim() : ''; if(k) lines.push(k+': '+v) });
      navigator.clipboard.writeText(lines.join('\n')).then(()=> showMessage('Results copied'))
    });

    document.getElementById('downloadCSV').addEventListener('click', ()=>{
      const rows = [
        ['field','value','binary'],
        ['Address', document.getElementById('b_address').textContent, document.getElementById('b_address_bin').innerText || ''],
        ['Netmask', document.getElementById('b_netmask').textContent, document.getElementById('b_netmask_bin').innerText || ''],
        ['Wildcard', document.getElementById('b_wildcard').textContent, document.getElementById('b_wildcard_bin').innerText || ''],
        ['Network', document.getElementById('b_network').textContent, document.getElementById('b_network_bin').innerText || ''],
        ['Broadcast', document.getElementById('b_broadcast').textContent, document.getElementById('b_broadcast_bin').innerText || ''],
        ['HostMin', document.getElementById('b_hostmin').textContent, document.getElementById('b_hostmin_bin').innerText || ''],
        ['HostMax', document.getElementById('b_hostmax').textContent, document.getElementById('b_hostmax_bin').innerText || ''],
      ];
      const csv = rows.map(r=> r.map(c=>'"'+String(c).replace(/"/g,'""')+'"').join(',')).join('\n');
      const blob = new Blob([csv],{type:'text/csv'}); const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = 'subnet.csv'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
    });

    // allow enter key
    addrInput.addEventListener('keydown', (e)=>{ if(e.key==='Enter') calcBtn.click() });
    prefixInput.addEventListener('keydown', (e)=>{ if(e.key==='Enter') calcBtn.click() });
  </script>
</body>
</html>
